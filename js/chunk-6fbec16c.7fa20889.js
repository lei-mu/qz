(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6fbec16c"],{1148:function(t,e,i){"use strict";var a=i("a691"),r=i("1d80");t.exports="".repeat||function(t){var e=String(r(this)),i="",o=a(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(i+=e);return i}},"25f0":function(t,e,i){"use strict";var a=i("6eeb"),r=i("825a"),o=i("d039"),n=i("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=s;(u||d)&&a(RegExp.prototype,s,(function(){var t=r(this),e=String(t.source),i=t.flags,a=String(void 0===i&&t instanceof RegExp&&!("flags"in c)?n.call(t):i);return"/"+e+"/"+a}),{unsafe:!0})},"408a":function(t,e,i){var a=i("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=a(t))throw TypeError("Incorrect invocation");return+t}},"44e7":function(t,e,i){var a=i("861d"),r=i("c6b6"),o=i("b622"),n=o("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==r(t))}},"466d":function(t,e,i){"use strict";var a=i("d784"),r=i("825a"),o=i("50c4"),n=i("1d80"),s=i("8aa5"),c=i("14c3");a("match",1,(function(t,e,i){return[function(e){var i=n(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,i):new RegExp(e)[t](String(i))},function(t){var a=i(e,t,this);if(a.done)return a.value;var n=r(t),l=String(this);if(!n.global)return c(n,l);var u=n.unicode;n.lastIndex=0;var d,f=[],h=0;while(null!==(d=c(n,l))){var p=String(d[0]);f[h]=p,""===p&&(n.lastIndex=s(l,o(n.lastIndex),u)),h++}return 0===h?null:f}]}))},"4d63":function(t,e,i){var a=i("83ab"),r=i("da84"),o=i("94ca"),n=i("7156"),s=i("9bf2").f,c=i("241c").f,l=i("44e7"),u=i("ad6d"),d=i("9f7f"),f=i("6eeb"),h=i("d039"),p=i("69f3").set,m=i("2626"),g=i("b622"),y=g("match"),v=r.RegExp,b=v.prototype,w=/a/g,T=/a/g,k=new v(w)!==w,C=d.UNSUPPORTED_Y,x=a&&o("RegExp",!k||C||h((function(){return T[y]=!1,v(w)!=w||v(T)==T||"/a/i"!=v(w,"i")})));if(x){var S=function(t,e){var i,a=this instanceof S,r=l(t),o=void 0===e;if(!a&&r&&t.constructor===S&&o)return t;k?r&&!o&&(t=t.source):t instanceof S&&(o&&(e=u.call(t)),t=t.source),C&&(i=!!e&&e.indexOf("y")>-1,i&&(e=e.replace(/y/g,"")));var s=n(k?new v(t,e):v(t,e),a?this:b,S);return C&&i&&p(s,{sticky:i}),s},R=function(t){t in S||s(S,t,{configurable:!0,get:function(){return v[t]},set:function(e){v[t]=e}})},_=c(v),E=0;while(_.length>E)R(_[E++]);b.constructor=S,S.prototype=b,f(r,"RegExp",S)}m("RegExp")},"8efe":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"tickTable",staticClass:"ticket-table",staticStyle:{width:"100%"},attrs:{data:t.tableData,"element-loading-text":"正在搜索中","element-loading-spinner":"el-icon-loading","default-sort":{prop:"minimumPrice",order:"ascending"}},on:{"sort-change":t.tableSortChange}},[a("div",{staticClass:"table-data-empty",attrs:{slot:"empty"},slot:"empty"},[a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.loadingType,expression:"loadingType === 1"}],staticClass:"no-data-container"},[a("img",{attrs:{src:i("cfa4"),alt:""}}),a("b",[t._v("未搜索到相关结果")]),a("p",[t._v("建议您修改筛选项后重新再试")])])]),a("el-table-column",{staticClass:"hide-arrow",attrs:{width:"10",type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.tickets,(function(i,r){return a("div",{key:"tk-"+r,staticClass:"ticket-item"},[a("p",{staticClass:"ticket-type"},[t._v(t._s(i.cabinName)+" "+t._s(t.discountText(i.discount)))]),a("div",{staticClass:"slot"}),a("div",{staticClass:"price"},[a("div",{staticClass:"price-text"},[a("span",[t._v("¥")]),a("p",[t._v(t._s(i.cabinPrice.adultSalePrice))])]),i.seatLeftNum<10?a("span",[t._v("仅剩"),a("span",{staticClass:"redFont"},[t._v(t._s(i.seatLeftNum))]),t._v("张")]):a("span",[t._v(t._s(t.buildTickCountText(i.seatLeftNum)))])]),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.toOrder(i,e.row)}}},[t._v(" "+t._s(t.willChBack||1!==t.wayTag?"订票":"设为去程")+" ")])],1)])}))}}])}),a("el-table-column",{attrs:{width:"320",label:"航班信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flightInfo"},[a("div",{staticClass:"flightIco"},[a("img",{attrs:{src:e.row.logo,alt:""}})]),a("div",{staticClass:"flightText"},[a("p",[t._v(t._s(e.row.airlineCompany))]),a("span",[t._v(t._s(e.row.flightNo)+" "+t._s(e.row.craftType))])])])]}}])}),a("el-table-column",{attrs:{width:"140",align:"right",label:"起飞时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"departuresText"},[a("p",[t._v(t._s(e.row.fromDateTime))]),a("span",[t._v(t._s(e.row.fromAirportName)+"机场 "+t._s(e.row.fromTerminal))])])]}}])}),a("el-table-column",{attrs:{width:"90"}},[[a("div",{staticClass:"long-arrow"},[a("div",{staticClass:"long-line"}),t._e()])]],2),a("el-table-column",{attrs:{width:"280",align:"left",label:"到达时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"departuresText",staticStyle:{"align-items":"flex-start"}},[a("p",[t._v(t._s(e.row.toDateTime)),a("b",[t._v(t._s(t.bindDay(e.row)))])]),a("span",[t._v(t._s(t.formatAirportName(e.row.toAirportName))+" "+t._s(e.row.toTerminal))])])]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"minimumPrice",label:"价格"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"price"},[a("div",{staticClass:"price-text"},[a("span",[t._v("¥")]),a("p",[t._v(t._s(e.row.minimumPrice))]),a("span",[t._v("起")])]),a("span",[t._v("经济舱 "+t._s(e.row.minimumDiscount&&1!=e.row.minimumDiscount?(10*e.row.minimumDiscount).toFixed(1)+"折起":""))])])]}}])}),a("el-table-column",{attrs:{width:"148",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t.openRows.indexOf(e.$index.toString())<0?a("el-button",{attrs:{type:"primary"},on:{click:function(i){return t.showMore(e.row,e.$index)}}},[t._v(" 选择 "),a("i",{staticClass:"el-icon-caret-bottom"})]):a("el-button",{staticStyle:{color:"#B79255"},attrs:{plain:""},on:{click:function(i){return t.showMore(e.row,e.$index)}}},[t._v(" 收起 "),a("i",{staticClass:"el-icon-caret-top"})])]}}])})],1),a("el-dialog",{attrs:{title:"信息提示",visible:t.showReloadTipDialog,"close-on-click-modal":!1,"show-close":!1,width:"500px"},on:{"update:visible":function(e){t.showReloadTipDialog=e}}},[a("b",[t._v("价格可能已经更新，已为您重新搜索")]),a("p",[t._v("距上次搜索已过去十分钟，重新搜索以提供更准确的价格")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.reloadTable}},[t._v("确 定")])],1)])],1)},r=[],o=(i("c975"),i("d81d"),i("a434"),i("a9e3"),i("b680"),i("4d63"),i("ac1f"),i("25f0"),i("466d"),i("96cf"),i("1da1")),n=i("d83f"),s=10,c={name:"table-ticket",components:{},props:{searchRule:{type:Object,default:function(){return{}}},tickOne:{type:Boolean,default:!1},wayTag:{type:Number,default:function(){return 0}}},data:function(){return{loading:!1,tableData:[],openRows:[],showReloadTipDialog:!1,queryWay:"",reloadTimer:"",willChBack:!1,loadingType:999,ticketsQuery:{},orderLock:!1}},computed:{},created:function(){},mounted:function(){this.setReloadTimer()},watch:{searchRule:{handler:function(){this.getTableData()},deep:!0},wayTag:{handler:function(t,e){},deep:!0}},beforeDestroy:function(){this.reloadTimer&&(clearTimeout(this.reloadTimer),this.reloadTimer="")},methods:{discountText:function(t){return console.log(t),t&&t<1?(10*t).toFixed(1)+"折":void 0},showMore:function(t,e){e+="",this.openRows.indexOf(e)>-1?(this.openRows.splice(this.openRows.indexOf(e),1),this.$refs.tickTable.toggleRowExpansion(t,!1)):(this.openRows.push(e),this.$refs.tickTable.toggleRowExpansion(t,!0))},tableSortChange:function(){var t=this;this.openRows=[];try{this.tableData.map((function(e){t.$refs.tickTable.toggleRowExpansion(e,!1)}))}catch(e){console.log(e)}},setReloadTimer:function(){var t=this;this.reloadTimer&&(clearTimeout(this.reloadTimer),this.reloadTimer=""),this.reloadTimer=setTimeout((function(){t.showReloadTipDialog=!0}),6e4*s)},reloadTable:function(){this.getTableData(this.queryWay),this.showReloadTipDialog=!1,this.setReloadTimer()},toOrder:function(t,e){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=i.$store.getters.isLogin,r){a.next=4;break}return i.$AqLogin.show(),a.abrupt("return");case 4:!i.wayTag||i.wayTag&&!i.willChBack?i.ticketsQuery={Sd:i.searchRule.sTime,Sfc:i.searchRule.startCity,Stc:i.searchRule.endCity,Scode:t.cabinBookPara,Sp:t.cabinPrice.adultSalePrice,Sac:e.airlineCompany,Sfn:e.flightNo,Sct:e.craftType,Sfan:e.fromAirportName,Stan:e.toAirportName,Sfac:e.fromAirportCode,Stac:e.toAirportCode,Sft:e.fromTerminal,Set:e.toTerminal,Sstm:e.fromDateTime,Setm:e.toDateTime,Slv:t.cabinLevel,Ssf:!!t.isShareFlight,Srf:t.isShareFlight?t.realFlightNo:"",Sfcc:i.searchRule.sCity,Secc:i.searchRule.eCity,Scc:t.cabinCode,St1:e.fromDate,St2:e.toDate,Slc:e.airlineCode,Saf:e.adultFuel,Sjj:e.adultTax}:i.wayTag&&i.willChBack&&(i.ticketsQuery.Ed=i.searchRule.eTime,i.ticketsQuery.Etc=i.searchRule.startCity,i.ticketsQuery.Efc=i.searchRule.endCity,i.ticketsQuery.Ecode=t.cabinBookPara,i.ticketsQuery.Ep=t.cabinPrice.adultSalePrice,i.ticketsQuery.Eac=e.airlineCompany,i.ticketsQuery.Efn=e.flightNo,i.ticketsQuery.Ect=e.craftType,i.ticketsQuery.Efan=e.fromAirportName,i.ticketsQuery.Etan=e.toAirportName,i.ticketsQuery.Eft=e.fromTerminal,i.ticketsQuery.Eet=e.toTerminal,i.ticketsQuery.Estm=e.fromDateTime,i.ticketsQuery.Eetm=e.toDateTime,i.ticketsQuery.Efac=e.fromAirportCode,i.ticketsQuery.Etac=e.toAirportCode,i.ticketsQuery.Elv=t.cabinLevel,i.ticketsQuery.Esf=!!t.isShareFlight,i.ticketsQuery.Erf=t.isShareFlight?t.realFlightNo:"",i.ticketsQuery.Efcc=i.searchRule.sCity,i.ticketsQuery.Eecc=i.searchRule.eCity,i.ticketsQuery.Ecc=t.cabinCode,i.ticketsQuery.Et1=e.fromDate,i.ticketsQuery.Et2=e.toDate,i.ticketsQuery.Elc=e.airlineCode,i.ticketsQuery.Eaf=e.adultFuel,i.ticketsQuery.Ejj=e.adultTax),0===i.wayTag||i.willChBack?i.checkCompanyUser():(i.$emit("toOrder",{ticket:t,flight:e}),i.willChBack=!0);case 6:case"end":return a.stop()}}),a)})))()},checkCompanyUser:function(){var t=this;this.orderLock||(this.orderLock=!0,this.$store.dispatch("getUserInfo").then((function(e){if(t.orderLock=!1,e){if(!e.companyName)return void t.$message.warning("暂无权限，请去用户中心切换至企业");t.$router.push({path:"/place-plane-order",query:t.ticketsQuery})}})).catch((function(){t.orderLock=!1})))},formatAirportName:function(t){var e="机场",i=RegExp(/机场/);return t.match(i)?t:t+e},bindDay:function(t){var e=new Date("2021-01-01 "+t.fromDateTime).getTime(),i=new Date("2021-01-01 "+t.toDateTime).getTime();if(i<e)return"+1天"},getTableData:function(t){var e=this;this.queryWay=t,this.$refs.tickTable.clearSort(),this.tableSortChange(),this.loading=!0,this.loadingType=999,1===t&&(this.willChBack=!1),n["a"].Air.getAirTickets({airlineCode:this.searchRule.aviationCop,isSingleTicket:t||(this.$props.wayTag?this.$props.wayTag:"1"),fromCity:this.searchRule.sCity?this.searchRule.sCity:void 0,toCity:this.searchRule.eCity?this.searchRule.eCity:void 0,flightDate:this.searchRule.sTime,backDate:this.searchRule.eTime,fromDateTime:this.formatTime(this.searchRule.stRange),toDateTime:this.formatTime(this.searchRule.etRange),quantity:this.searchRule.quantity,cabinLevel:this.searchRule.chFlight}).then((function(t){var i=t.data;200===i.code?(e.tableData=i.data,e.setReloadTimer(),e.loadingType=0===i.data.length?1:999):(e.loadingType=999,e.$message.error(i.msg)),e.loading=!1})).catch((function(){e.loadingType=999,e.tableData=[],e.$message.error("网络错误，请重新尝试"),e.loading=!1}))},buildTickCountText:function(t){return t<10?"剩余"+t+"张":"余票充足"},formatTime:function(t){if(t){var e=t[0]<10?"0"+t[0]:t[0],i=t[1]<10?"0"+t[1]:t[1];return e+":00-"+i+":00"}}}},l=c,u=(i("9ed9"),i("2877")),d=i("9bb6"),f=i.n(d),h=Object(u["a"])(l,a,r,!1,null,"64b00738",null);"function"===typeof f.a&&f()(h);e["default"]=h.exports},"9bb6":function(t,e){},"9ed9":function(t,e,i){"use strict";i("a4d2")},a434:function(t,e,i){"use strict";var a=i("23e7"),r=i("23cb"),o=i("a691"),n=i("50c4"),s=i("7b0b"),c=i("65f0"),l=i("8418"),u=i("1dde"),d=i("ae40"),f=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,m=Math.min,g=9007199254740991,y="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!h},{splice:function(t,e){var i,a,u,d,f,h,v=s(this),b=n(v.length),w=r(t,b),T=arguments.length;if(0===T?i=a=0:1===T?(i=0,a=b-w):(i=T-2,a=m(p(o(e),0),b-w)),b+i-a>g)throw TypeError(y);for(u=c(v,a),d=0;d<a;d++)f=w+d,f in v&&l(u,d,v[f]);if(u.length=a,i<a){for(d=w;d<b-a;d++)f=d+a,h=d+i,f in v?v[h]=v[f]:delete v[h];for(d=b;d>b-a+i;d--)delete v[d-1]}else if(i>a)for(d=b-a;d>w;d--)f=d+a-1,h=d+i-1,f in v?v[h]=v[f]:delete v[h];for(d=0;d<i;d++)v[d+w]=arguments[d+2];return v.length=b-a+i,u}})},a4d2:function(t,e,i){},b680:function(t,e,i){"use strict";var a=i("23e7"),r=i("a691"),o=i("408a"),n=i("1148"),s=i("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,i){return 0===e?i:e%2===1?u(t,e-1,i*t):u(t*t,e/2,i)},d=function(t){var e=0,i=t;while(i>=4096)e+=12,i/=4096;while(i>=2)e+=1,i/=2;return e},f=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));a({target:"Number",proto:!0,forced:f},{toFixed:function(t){var e,i,a,s,c=o(this),f=r(t),h=[0,0,0,0,0,0],p="",m="0",g=function(t,e){var i=-1,a=e;while(++i<6)a+=t*h[i],h[i]=a%1e7,a=l(a/1e7)},y=function(t){var e=6,i=0;while(--e>=0)i+=h[e],h[e]=l(i/t),i=i%t*1e7},v=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==h[t]){var i=String(h[t]);e=""===e?i:e+n.call("0",7-i.length)+i}return e};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(e=d(c*u(2,69,1))-69,i=e<0?c*u(2,-e,1):c/u(2,e,1),i*=4503599627370496,e=52-e,e>0){g(0,i),a=f;while(a>=7)g(1e7,0),a-=7;g(u(10,a,1),0),a=e-1;while(a>=23)y(1<<23),a-=23;y(1<<a),g(1,1),y(2),m=v()}else g(0,i),g(1<<-e,0),m=v()+n.call("0",f);return f>0?(s=m.length,m=p+(s<=f?"0."+n.call("0",f-s)+m:m.slice(0,s-f)+"."+m.slice(s-f))):m=p+m,m}})},c975:function(t,e,i){"use strict";var a=i("23e7"),r=i("4d64").indexOf,o=i("a640"),n=i("ae40"),s=[].indexOf,c=!!s&&1/[1].indexOf(1,-0)<0,l=o("indexOf"),u=n("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(t){return c?s.apply(this,arguments)||0:r(this,t,arguments.length>1?arguments[1]:void 0)}})},cfa4:function(t,e){t.exports="https://cdn.jsdelivr.net/gh/lei-mu/qz/img/no_data.ad7b1bcd.png"},d81d:function(t,e,i){"use strict";var a=i("23e7"),r=i("b727").map,o=i("1dde"),n=i("ae40"),s=o("map"),c=n("map");a({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);